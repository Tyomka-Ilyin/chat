(function(){"use strict";var e={9178:function(e,s,t){var r=t(9242),o=t(3396),n=t(7139);const i={class:"container d-flex align-items-center justify-content-center min-vh-100"},u={class:"column w-50"},a={ref:"listMessages",style:{overflow:"hidden","overflow-y":"scroll",height:"300px"}},l={class:"col-sm-3"},c={class:"col-sm-9"},f={ref:"bottomEl"},m={key:0,class:"form-group text-center"},h={key:1,ref:"formMessage",class:"form-group text-center"},d={ref:"messageInput",type:"text",class:"form-control",placeholder:"Сообщение"},p={class:"column w-30",style:{"margin-left":"10px"}},g=(0,o._)("header",null,"Подключенные пользователи",-1),v={ref:"listUsers",style:{"overflow-y":"scroll",height:"360px"},class:"border"},w={class:"col-sm-3"};function b(e,s,t,b,y,_){return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",u,[(0,o._)("div",a,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(this.$messages,(e=>((0,o.wg)(),(0,o.iD)("dl",{class:"row",key:e.id},[(0,o._)("dt",l,(0,n.zw)(e.user)+":",1),(0,o._)("dd",c,(0,n.zw)(e.message),1)])))),128)),(0,o._)("div",f,null,512)],512),y.showInput?((0,o.wg)(),(0,o.iD)("div",m,[(0,o.wy)((0,o._)("input",{ref:"userName","onUpdate:modelValue":s[0]||(s[0]=e=>y.userName=e),type:"text",class:"form-control",placeholder:"Имя пользователя"},null,512),[[r.nr,y.userName]]),(0,o._)("button",{onClick:s[1]||(s[1]=e=>_.connectToChat()),class:"form-control btn btn-primary"},"Подключиться")])):(0,o.kq)("",!0),y.showInput?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",h,[(0,o._)("input",d,null,512),(0,o._)("button",{onClick:s[2]||(s[2]=e=>_.sendMessage()),class:"form-control btn btn-primary"},"Отправить")],512))]),(0,o._)("div",p,[g,(0,o._)("div",v,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(this.$users,(e=>((0,o.wg)(),(0,o.iD)("dl",{class:"row",key:e.id},[(0,o._)("dt",w,(0,n.zw)(e.userName),1)])))),128))],512)])])}t(560);var y={data(){return{userName:"",showInput:!0,users:[],messages:[]}},sockets:{message(e){console.log(e.user+" "+e.message),this.$messages.push(e),this.$forceUpdate(),setTimeout((()=>{this.scrollToLast()}),100)},connected(e){console.log(e),this.$users=e.users,this.$messages=e.messages,this.$forceUpdate(),this.scrollToLast()},newUser(e){console.log("new user: "+e),this.$users.push(e),this.$forceUpdate()},removeUser(e){this.$users.splice(e.id,1),this.$forceUpdate()}},mounted(){this.scrollToLast()},methods:{connectToChat(){this.showInput=!1,this.$socket.emit("addUser",{userName:this.$refs.userName.value}),this.userName=this.$refs.userName.value,window.addEventListener("beforeunload",(e=>{this.$socket.emit("removeClient",{userName:this.userName}),e.returnValue=""}))},sendMessage(){var e={user:this.userName,message:this.$refs.messageInput.value};this.$socket.emit("message",e),this.$refs.messageInput.value=""},scrollToLast(){console.log("scrolled"),this.$refs.bottomEl?.scrollIntoView({behavior:"smooth"})}}},_=t(89);const $=(0,_.Z)(y,[["render",b]]);var k=$,S=t(65);let x=new S.ZP.Store({state:{users:[],messages:[]},mutations:{ADD_USER(e,s){e.users.push(s)},ADD_MESSAGE(e,s){e.messages.push(s)},SET_MESSAGES(e,s){e.messages=s}},actions:{},getters:{USERS(e){return e.users},MESSAGES(e){return e.messages}}});var O=x,E=t(2723),N=t.n(E),T=t(4488);const D=(0,r.ri)(k),U=new(N())({debug:!0,connection:(0,T.ZP)("https://chat-server-zmq2.onrender.com/",{transports:["websocket"]}),extraHeaders:{"Access-Control-Allow-Origin":"*"}});D.use(U),D.use(O),D.mount("#app")}},s={};function t(r){var o=s[r];if(void 0!==o)return o.exports;var n=s[r]={exports:{}};return e[r].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(s,r,o,n){if(!r){var i=1/0;for(c=0;c<e.length;c++){r=e[c][0],o=e[c][1],n=e[c][2];for(var u=!0,a=0;a<r.length;a++)(!1&n||i>=n)&&Object.keys(t.O).every((function(e){return t.O[e](r[a])}))?r.splice(a--,1):(u=!1,n<i&&(i=n));if(u){e.splice(c--,1);var l=o();void 0!==l&&(s=l)}}return s}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[r,o,n]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var r in s)t.o(s,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:s[r]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(s){return 0===e[s]};var s=function(s,r){var o,n,i=r[0],u=r[1],a=r[2],l=0;if(i.some((function(s){return 0!==e[s]}))){for(o in u)t.o(u,o)&&(t.m[o]=u[o]);if(a)var c=a(t)}for(s&&s(r);l<i.length;l++)n=i[l],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(c)},r=self["webpackChunkchat"]=self["webpackChunkchat"]||[];r.forEach(s.bind(null,0)),r.push=s.bind(null,r.push.bind(r))}();var r=t.O(void 0,[998],(function(){return t(9178)}));r=t.O(r)})();
//# sourceMappingURL=app.3e7c7c1d.js.map